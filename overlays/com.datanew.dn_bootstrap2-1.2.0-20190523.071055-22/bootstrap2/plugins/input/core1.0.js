(function(d){d.extend({globalValid:d.extend({},{email:{reg:/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,text:"邮箱格式错误"},idcard:{reg:/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/,text:"身份证格式错误"},phone:{reg:/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/,text:"手机号码格式错误"}},d.globalValidConfig),textBoxDefault:d.extend({},{width:"100%",height:"auto",thousandsNum:false,multiline:false,disabled:false,placeholder:"",required:false,hoverTips:false,defaultValue:"",validFail:function(m){return false},validSuccess:function(m){return false},onChange:function(){},onInputChange:function(n,m){},onLoaded:function(m){}},d.textBoxConfig),dateBoxDefault:d.extend({},{disabled:false,format:"yyyy-mm-dd",minView:2,startView:4,onChange:function(p,n,m,o){},onDone:function(n,m,o){},onLoaded:function(m){}},d.dateBoxConfig),comboBoxDefault:d.extend({},{valueField:"id",textField:"text",pinyinSearch:false,localdata:[],url:"",selected:"",queryParam:{},panelWidth:"auto",panelHeight:"auto",multiple:false,separator:",",disabled:false,hasDownArrow:true,value:"",isGetText:false,getTextField:"",onShowPanel:function(){return false},onHidePanel:function(){return false},onChange:function(o,n,m){},onClickInput:function(m){},onClick:function(){return false}},d.comboBoxConfig),comboTreeDefault:d.extend({},{onlyLeaf:false,checkType:"nocheck",rootElement:false,check:{},isGetText:false,getTextField:"",data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}},callback:{}},d.comboTreeConfig),searchTreeDefault:d.extend({},{openSearch:true,dblEnterSearch:false,modalWidth:"auto",modalHeight:"auto",modalTitle:"",check:{},url:"",checkType:"radio",editInput:false,isGetText:false,getTextField:"",data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}},onAckCallback:function(){return false},onCloseCallback:function(){return false},onChange:function(o,n,m){return false},onLoaded:function(){return false},onClickInput:function(m){},callback:{clickNode:function(p,o,n,m){return false}},view:{showIcon:false}},d.searchTreeConfig),treeDefault:d.extend({},{async:{dataType:"text",autoParam:[],enable:false,otherParam:[],url:""},url:"",outerHeight:undefined,fixedTreeHeight:d(window).height()-40,rootElement:false,ISLEAF:false,checkType:"radio",queryParam:{},check:{},openSearch:false,searchAttr:"name",data:{simpleData:{enable:true,idKey:"id",pIdKey:"pId",rootPId:"0"},key:{checked:"checked",children:"children",name:"name",title:"",url:""}},getValueField:"",view:{showIcon:false},callback:{clickNode:function(p,o,n,m){return false}},onLoaded:function(m){}},d.treeConfig),decimalDefault:d.extend({},{width:"100%",height:"auto",placeholder:"",required:false,defaultValue:"",decimalPlaces:2},d.decimalConfig),textEditorDefault:d.extend({},{toolbarCanCollapse:true,hoverTips:false,validFail:function(m){return false},validSuccess:function(m){return false},onLoaded:function(m){}},d.textEditorConfig),iconBoxDefault:d.extend({},{multiple:false,url:"",idKey:"id",iconKey:"icon",classKey:"classes",defaultValue:"",queryParam:{},validFail:function(m){return false},validSuccess:function(m){return false}},d.iconBoxConfig),radioBoxDefault:d.extend({},{url:"",localdata:[],radioName:"",disabled:false,required:false,multiple:false,valueField:"id",textField:"text",queryParam:{},validFail:function(m){return false},validSuccess:function(m){return false},onChange:function(o,n,m){},onLoaded:function(m){}},d.radioBoxConfig)});var g=f({init:function(n,m){this.$textBox=d(n);this.$valueBox;this.$outerBox;this.options=m;this.initBox()}});d.fn.textBox=function(m){var p=d(this),o=null;if(typeof m=="object"){o=p.data("textBox");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.textBoxDefault,m);if(m.multiline){p=d.replaceTag(d(this),"TEXTAREA")}else{if(m.isPassword&&navigator.userAgent.indexOf("MSIE 8.0")>=0){p=d.replaceTag(d(this),"DIV");p.attr("type","password");p=d.replaceTag(p,"INPUT")}else{p=d.replaceTag(d(this),"INPUT")}}p.data("textBox",new g(p,m));p.data("type","textBox");m.onLoaded.call(this,p);return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("textBox");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};g.prototype.initBox=function(){var o=this.$textBox,m=this.options;if(m.multiline){if(m.height=="auto"){o.css({height:"80px",resize:"none"})}o.css({"font-family":"monospace"})}this.$textBox.wrap('<span class="ztreeBox_inp ztreeBox_down "></span>').after("<input type='hidden' class='valueBox'/>").addClass("form-control input-sm").attr({placeholder:this.options.placeholder});this.$valueBox=o.next(".valueBox");this.$outerBox=o.parent().css({width:m.width,height:m.height});this.$valueBox=this.$outerBox.find(".valueBox").attr("boxType","textBox");this.$textBox.attr({autocomplete:"off"});if(m.isPassword){if(navigator.userAgent.indexOf("MSIE 8.0")===-1){this.$textBox.attr({type:"password"})}this.$textBox.attr({autocomplete:"new-password"})}if(m.id){this.$textBox.attr("id",m.id)}if(m.hasOwnProperty("dname")){this.$valueBox.attr("dname",m.dname)}if(this.$textBox.attr("dname")!=undefined){this.$valueBox.attr("dname",this.$textBox.attr("dname"));this.$textBox.removeAttr("dname")}if(m.hasOwnProperty("name")){this.$valueBox.attr("name",m.name)}if(this.$textBox.attr("name")!=undefined){this.$valueBox.attr("name",this.$textBox.attr("name"));this.$textBox.removeAttr("name")}try{if(m.defaultValue!==""&&m.type!=="searchTree"&&m.type!=="comboTree"){this.setValue(m.defaultValue)}}catch(p){}this.$textBox.addClass("bgwhite");if(m.hoverTips&&m.hoverTips!==""){var n=d('<i class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="top" title="'+m.hoverTips+'"></i>').insertBefore(this.$textBox);n.tooltip()}this.onTrigger();this.onInputChange()};g.prototype.onTrigger=function(){var p=this,o=this.$textBox,n=this.$valueBox;o.off("blur").on("blur",function(r){p.$outerBox.removeClass("has-error");n.val(o.val());if(p.options.required||p.options.validate){var q=p.validate();if(!q){p.options.validFail.apply(this,[p.$textBox])}else{p.options.validSuccess.apply(this,[p.$textBox])}}});o.off("keydown").on("keydown",function(q){n.val(o.val())});o.off("change").on("change",function(q){n.val(o.val());p.changeValue(p.$valueBox.val(),p.$textBox.val(),p.options)});if(this.options.thousandsNum){o.on("keyup",function(r){r=window.event||r;if(r.keyCode==37||r.keyCode==39){return}var q=o.val().replace(/[^\d.]/g,"");o.val(m(q)).on("blur",function(){n.val(q)})});function m(r){if(r==""||r==null){return r}else{var t=r.indexOf(".");if(t==-1){return(r||0).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}else{var q=r.split(".");return(q[0]||0).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")+"."+q[1]}}}}};g.prototype.onInputChange=function(){var p=this,m=p.options,o=p.$textBox,n=p.$valueBox;o.off("input propertychange").on("input propertychange",function(){var r=o.val(),q=n.val();m.onInputChange.apply(this,[r,q])})};g.prototype.destroy=function(){this.$textBox.removeData("textBox");this.$outerBox.remove()};g.prototype.tips=function(n,m){layer.tips(n,m,{tipsMore:true,time:2000})};g.prototype.changeValue=function(r,q,p){var o=this.$textBox,n=this.$valueBox,m=this.$textBox.data("oldValue")==undefined?"":this.$textBox.data("oldValue");if(r==m){return}o.val(q);n.val(r);o.data("oldValue",r);this.options.onChange.apply(this,[r,m,p])};g.prototype.validate=function(){var n=true,s=d.trim(this.$valueBox.val()),r=this,o=this.options,q=this.$textBox;if(q.is(":disabled")||q.is(":hidden")){return n}if(o.required&&s==""){this.tips("该选项为必填",this.$outerBox);this.$outerBox.addClass("has-error");return false}if(typeof o.validate=="function"){var t=o.validate.apply(o,[q.val(),s,q]);if(t&&t.result==false){this.tips(t.msg,r.$outerBox);this.$outerBox.addClass("has-error");return t.result}}else{if(typeof o.validate=="string"){var p=o.validate.split("|"),m;d.each(p,function(u,w){n=d.globalValid[w].reg.test(s);m=d.globalValid[w].text;if(!n){return false}});if(!n){r.tips(m,r.$outerBox)}}}if(n){this.$outerBox.removeClass("has-error")}else{this.$outerBox.addClass("has-error")}return n};g.prototype.clear=function(){this.$valueBox.val("");this.$textBox.val("");this.$textBox.data("oldValue","")};g.prototype.getValue=function(){if(!!this.$valueBox.prop("disabled")){return false}return this.$valueBox.val()};g.prototype.setValue=function(m){this.$valueBox.val(m);this.$textBox.val(m)};g.prototype.readonly=function(){this.$textBox.attr({readonly:"readonly",disabled:false}).addClass("readonly").removeClass("bgwhite")};g.prototype.disable=function(){this.$textBox.attr("disabled","disabled").removeClass("bgwhite")};g.prototype.enable=function(){this.$textBox.removeAttr("disabled").addClass("bgwhite").removeClass("readonly")};g.prototype.setDisabled=function(m){if(m==true){this.disable();this.$valueBox.attr("disabled","disabled")}else{this.enable();this.$valueBox.removeAttr("disabled");var n=this.$textBox.siblings(".valueBox").attr("boxtype");if(n!="dateBox"&&n!="searchTree"&&n!="comboBox"&&n!="comboTree"){this.$textBox.removeAttr("readonly")}}};g.prototype.setReadonly=function(m){if(m==true){this.disable()}else{this.enable()}};g.prototype.getText=function(){if(!!this.$valueBox.prop("disabled")){return false}return this.$textBox.val()};g.prototype.setText=function(m){this.$textBox.val(m)};var a=f(g,{init:function(n,m){this.base(n,m);this.initDateBox()}});d.fn.dateBox=function(m){var p=d.replaceTag(d(this),"INPUT"),o=null;if(typeof m=="object"){m=d.extend({},d.extend({},d.textBoxDefault,d.dateBoxDefault),m);d.include([__bootstrapVersionPath+"/plugins/laydate/laydate.js",__bootstrapVersionPath+"/plugins/laydate/theme/default/laydate-custom.css"]);laydate.path=d.getRootPath()+"/"+__bootstrapVersionPath+"/plugins/laydate/";o=p.data("dateBox");if(o!=null){o.options=d.extend({},o.options,m);return}var r=new a(p,m);p.data("dateBox",r);p.data("type","dateBox");return r.laydateObj}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("dateBox");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};a.prototype.initDateBox=function(){var q=this.$textBox,p=this.$valueBox,m=this.options,o=this,n="";o.$outerBox.addClass("input-group date").css({width:m.width=="100%"?"":m.width});if(m.minView==4||m.minView==="decade"){n="year"}else{if(m.minView==3||m.minView==="year"){n="month"}else{if(m.minView==2||m.minView==="month"){n="date"}else{if(m.minView==0||m.minView==1||m.minView==="hour"){n="datetime"}}}}if(m.startView==1||m.startView==="day"){n="time"}m.format=m.format.replace(/m/g,"M");m.format=m.format.replace(/i/g,"m");m.format=m.format.replace(/h/g,"H");var r={elem:q.get(0),type:n};m=d.extend({},m,r);m.ready=function(s){m.onLoaded.call(o,s)};m.done=function(t,s,u){o.setValue(t);m.onDone.call(o,t,s,u);o.validate()};m.change=function(u,t,w){o.setValue(u);var s=o.getValue();m.onChange.call(o,u,s,t,w)};o.laydateObj=laydate.render(m);if(m.disabled){q.attr("disabled","disabled").removeClass("bgwhite")}this.$valueBox.attr("boxType","dateBox")};a.prototype.setValue=function(m){this.$textBox.val(m);this.$valueBox.val(m)};a.prototype.readonly=function(){this.$outerBox.addClass("dateInput-readonly");this.$textBox.attr({readonly:"readonly",disabled:false}).addClass("readonly").removeClass("bgwhite")};a.prototype.disable=function(){this.$textBox.attr("disabled","disabled").removeClass("bgwhite")};a.prototype.enable=function(){var n=this.$textBox,m=this.$valueBox;this.$outerBox.removeClass("dateInput-readonly");this.$textBox.removeAttr("disabled").addClass("bgwhite").removeClass("readonly")};var h=f(g,{init:function(n,m){this.base(n,m);this.initPanel();this.initPanelContent();this.datas;this.$panel;this.$arrows}});d.fn.comboBox=function(m){var p=d.replaceTag(d(this),"INPUT"),o=null;if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/bootstrap-zTree-custom.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);d.include([__bootstrapVersionPath+"/css/font-awesome.min.css"]);o=p.data("comboBox");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.extend({},d.textBoxDefault,d.comboBoxDefault),m);p.data("comboBox",new h(p,m));p.data("type","comboBox");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=d(this).data("comboBox");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};h.prototype.initPanel=function(){var p=this.$textBox,o=this,m=this.options;if(p.parent().siblings().is(".control-identify")){p.parent().siblings().remove()}if(m.labeltitle){if(m.labelbreadth==undefined){m.labelbreadth="100px"}p.parent().before('<label class="control-label control-identify" for="" style="width:'+m.labelbreadth+' ;line-height:30px;text-align:center;">'+m.labeltitle+"</label>");p.parent().parent().css("display","flex")}p.after('<i class="fa fa-angle-down combo-box-arrows"></i>').after('<div  class="combo-panel"></div>');this.$valueBox.attr("boxType","comboBox");this.$arrows=this.$outerBox.find(".fa.fa-angle-down");if(String(m.hasDownArrow)=="false"){this.$arrows.hide()}this.$panel=this.$outerBox.find(".combo-panel");var q=this.options.panelWidth;var n=this.options.panelHeight;this.$panel.css({width:q=="auto"?"100%":q,height:n});if(m.parent){this.$panel.appendTo(d("body"))}p.removeAttr("style").css({width:"100%"}).attr({readonly:"true"}).data("oldValue","");this.$valueBox.on("focus",function(){o.clickToggle()});this.$arrows.off("click").on("click",function(){o.clickToggle()});if(this.options.pinyinSearch){this.$textBox.off("focus").on("focus",function(){o.clickToggle()})}else{this.$textBox.off("click").on("click",function(){o.clickToggle()})}this.$valueBox.off("focus").on("focus",function(){o.$textBox.trigger("click")})};h.prototype.clickToggle=function(){var m=this.options;m.onClick.apply(this,[]);if(this.$panel.is(":hidden")){this.showPanel()}else{if(!this.options.pinyinSearch){this.hidePanel()}}m.onClickInput.apply(this,[this.$textBox])};h.prototype.onTrigger=function(){};h.prototype.reload=function(n){var m=this.$valueBox.val();this.$panel.children().remove();if(n.hasOwnProperty("url")){this.options.url=n.url}else{this.options.localdata=n}if(n.hasOwnProperty("queryParam")){this.options.queryParam=n.queryParam}this.initPanelContent();this.setValue(m)};h.prototype.showPanel=function(){var o=this,m=o.options,n=o.$textBox;if(m.parent){o.$panel.css({left:n.offset().left,top:n.offset().top+n.outerHeight(),width:m.panelWidth=="auto"?n.outerWidth():m.panelWidth})}this.$panel.show();if(o.$valueBox.attr("boxtype")==="comboBox"&&!m.multiple){if(o.$valueBox.val()===""){o.$panel.find(".comboBox_option").eq(0).addClass("comboBox_option_check")}else{o.$panel.scrollTop(o.$panel.find(".comboBox_option_check").eq(0).position().top)}}this.options.onShowPanel.apply(this,[this.$textBox]);d(document).on("mousedown",function(p){o.onBodyDown(p)}).on("keyup",function(){if(!n.is(":focus")){o.hidePanel()}})};h.prototype.onBodyDown=function(n){var m=d(n.target),o="";if(m.parent()){o=m.parent().attr("class")+""}if(!(m.parent().hasClass("combo-panel")||m.hasClass("comboBox_option")||m.hasClass("node_name")||o.indexOf("level")!=-1||o.indexOf("ztreeBox_down")!=-1)||(m.is(":input")&&m.attr("id")!=this.$textBox.attr("id"))){this.hidePanel()}};h.prototype.hidePanel=function(){var m=this.options;if(this.$panel.is(":hidden")){return}if(m.pinyinSearch){this.$panel.find(".comboBox_option").show()}this.$panel.hide();if(m.required==true||m.validate!=null){this.validate()}this.options.onHidePanel.apply(this)};h.prototype.initPanelContent=function(){var p=this,n=p.$textBox,u=this.options,t=u.textField,s=u.valueField;if(u.localdata.length){this.datas=u.localdata;o()}else{d.ajax({type:"POST",url:u.url,dataType:"json",async:d.plugAsyncConfig||false,data:u.queryParam,success:function(w){p.datas=w;o();if(u.formInitCallBack!=null){u.formInitCallBack(u.name)}},error:function(){}})}function o(){var A=new Object();if(u.searchOption==true){var y=false;d.each(p.datas,function(C){if(p.datas[C].text=="全部"){y=true;return false}});if(!y){A[t]="全部";A[s]="ALL";p.datas.unshift(A)}}else{if(u.searchOption==false){var x=false;d.each(p.datas,function(C){if(p.datas[C].text==""){x=true;return false}});if(!x){A[t]="";A[s]="";p.datas.unshift(A)}}}d.each(p.datas,function(C,D){var E=d("<div/>").addClass("comboBox_option").text(this[t]).attr("value",this[s]);p.$panel.append(E);d(E).data("optionObj",D);E.off("click").on("click",function(){var J=d(this),H="",F="",G=p.$textBox.data("oldValue"),I=[];if(!u.multiple){p.$panel.find(".comboBox_option").removeClass("comboBox_option_check");J.addClass("comboBox_option_check");p.$textBox.val(d(this).text())}else{J.toggleClass("comboBox_option_check")}d.each(p.$panel.find(".comboBox_option_check"),function(K,L){I.push(d(L).data("optionObj"));H+=d(L).text()+u.separator;F+=d(L).attr("value")+u.separator});if(H.length>0){H=H.substring(0,H.length-1);F=F.substring(0,F.length-1)}p.changeValue(F,H,I.length==1?I[0]:I);if(!u.multiple){p.hidePanel()}})});var B=p.$valueBox.val()||u.defaultValue;if(B!==""){p.setValue(B);n.data("oldValue",B)}if(u.selected){var w=p.$panel.find(".comboBox_option"),z=w.eq((u.selected)-1).attr("value");p.setValue(z);n.data("oldValue",z)}}n.on("keydown",function(z){z=window.event||z;var y=p.$panel.find(".comboBox_option_check").eq(0),B=y.outerHeight();if(z.keyCode===38){var x=y.prevAll(":visible").eq(0);if(x.length===0){return}x.addClass("comboBox_option_check").siblings().removeClass("comboBox_option_check");if(x.position().top<p.$panel.scrollTop()){p.$panel.scrollTop(p.$panel.scrollTop()-B)}z.preventDefault()}else{if(z.keyCode===40){var w=y.nextAll(":visible").eq(0);if(w.length===0){return}w.addClass("comboBox_option_check").siblings().removeClass("comboBox_option_check");if(w.position().top+B*3>p.$panel.height()){p.$panel.scrollTop(p.$panel.scrollTop()+B)}z.preventDefault()}else{if(z.keyCode===13){var A=y.attr("value");p.changeValue(A,y.text(),y.data("optionObj"));p.setValue(A);p.hidePanel();n.blur()}}}});if(u.pinyinSearch){d.include(__bootstrapVersionPath+"/plugins/input/cn.js");n.removeAttr("readonly").on("blur",function(){if(p.$valueBox.val()===""){p.clear()}});var q=new PinyinEngine(p.datas,[t]);var m;var r=n.val();n.on("input propertychange",function(){var w=n.val();if(w===r){return}r=n.val();p.$panel.find(".comboBox_option").removeClass("comboBox_option_check").hide();p.$valueBox.val("");clearTimeout(m);m=setTimeout(function(){var x=q.query(w);if(x.length>0){d.each(x,function(y){if(w===x[y][t]){p.setValue(x[y][s])}d.each(p.datas,function(z){if(x[y][s]==p.datas[z][s]){p.$panel.find(".comboBox_option").eq(z).show()}})});p.$panel.find(".comboBox_option:visible").eq(0).addClass("comboBox_option_check")}},40)})}};h.prototype.clear=function(){this.$panel.find(".comboBox_option_check").removeClass("comboBox_option_check");this.$valueBox.val("");this.$textBox.val("");this.$textBox.data("oldValue","")};h.prototype.readonly=function(){this.$textBox.attr({readonly:"readonly",disabled:false}).addClass("readonly").removeClass("bgwhite");this.$textBox.off("click");this.$arrows.off("click")};h.prototype.disable=function(){this.$textBox.attr("disabled","disabled").removeClass("bgwhite");this.$arrows.off("click")};h.prototype.enable=function(){var m=this;this.$textBox.removeAttr("disabled").addClass("bgwhite").removeClass("readonly");this.$textBox.off("click").on("click",function(){m.clickToggle()});this.$arrows.off("click").on("click",function(){m.clickToggle()})};h.prototype.setValue=function(n){var r=this,m="",n=n+"",q=[],o=this.options;if(n===""){r.clear();return false}if(o.multiple){if(n.indexOf(",")==-1){q[0]=n}else{q=n.split(",")}for(k in q){m+="[value='"+q[k]+"']"+o.separator}m=m.substring(0,m.length-1);this.$panel.children().removeClass("comboBox_option_check");var p=this.$panel.find(m);var s="";d.each(p,function(t,u){s+=d(u).text()+o.separator;d(u).addClass("comboBox_option_check")});s=s.substring(0,s.length-1);this.$textBox.val(s);this.$valueBox.val(n)}else{this.$panel.find("[value='"+n+"']").each(function(){d(this).addClass("comboBox_option_check").siblings().removeClass("comboBox_option_check");r.$valueBox.val(n);r.$textBox.val(d(this).text())})}r.$textBox.data("oldValue",n)};var i=f(h,{init:function(n,m){this.base(n,m);this.$tree;this.ztree}});d.fn.comboTree=function(m){var p=d.replaceTag(d(this),"INPUT"),o=null;if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/bootstrap-zTree-custom.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);d.include([__bootstrapVersionPath+"/css/font-awesome.min.css"]);o=p.data("comboTree");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.extend({},d.extend({},d.textBoxDefault,d.comboBoxDefault),d.treeDefault),m);p.data("comboTree",new i(p,m));p.data("type","comboTree");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("comboTree");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};i.prototype.initPanelContent=function(){var q=this,p=this.$textBox.attr("id")!=null?this.$textBox.attr("id")+"_tree":"comboTree_"+new Date().getTime(),n=this.options;this.$valueBox.attr("boxType","comboTree");q.$tree=d("<ul />").addClass("ztree").attr({id:p});q.$panel.append(q.$tree);this.$valueBox.attr("boxType","comboTree");this.$textBox.data("oldValue","");function m(){if(!n.multiple){n.check.enable=false;n.callback.onClick=function(r,t,s){if((s.ISLEAF==0||s.isParent)&&n.onlyLeaf){return}value=s[n.data.simpleData.idKey];text=s[n.data.key.name];q.changeValue(value,text,s);q.hidePanel();n.callback.clickNode.call(q,r,t,s)}}else{n.checkType="checkbox";n.check.enable="true";n.callback.onCheck=function(t,s,r){nodes=q.ztree.getCheckedNodes(true),v="",dv="";d.each(nodes,function(u,w){if((w.ISLEAF==0||w.isParent)&&n.onlyLeaf){w.nocheck=true;return true}v+=w[n.data.key.name]+n.separator;dv+=w[n.data.simpleData.idKey]+n.separator});if(v.length>0){v=v.substring(0,v.length-1);dv=dv.substring(0,dv.length-1)}q.changeValue(dv,v,nodes)};n.callback.onClick=function(r,t,s){if((s.ISLEAF==0||s.isParent)&&n.onlyLeaf){return}q.ztree.checkNode(s,!s.checked,null,true);n.callback.clickNode.call(q,r,t,s)}}}if(n.url!=""){d.ajax({type:"POST",dataType:"json",async:d.plugAsyncConfig||false,url:n.url,data:n.queryParam,success:function(r){m();q.datas=r;q.processDate();q.ztree=d.fn.zTree.init(q.$tree,n,q.datas);o();if(n.formInitCallBack!=null){n.formInitCallBack(n.name)}n.onLoaded.call(q.$tree,q.ztree)}})}else{if(n.async!=null&&n.async.enable){m();q.ztree=d.fn.zTree.init(q.$tree,n);o();n.onLoaded.call(q.$tree,q.ztree)}else{m();q.datas=n.localdata;q.processDate();q.ztree=d.fn.zTree.init(q.$tree,n,q.datas);o();n.onLoaded.call(q.$tree,q.ztree)}}function o(){var r=q.$valueBox.val()||n.defaultValue;q.setValue(r);q.$textBox.data("oldValue",r)}};i.prototype.setValue=function(o){if(this.ztree==null){return}var q=this,s="",n=[],r="",p=this.options,o=o+"",m=this.ztree.getNodesByParam(p.data.simpleData.idKey,o);if(m.length===0){q.clear();return false}if(p.multiple){if(o.indexOf(",")==-1){n[0]=o}else{n=o.split(",")}if(n.length==0){return}m=this.ztree.getNodesByFilter(function(t){return d.inArray(t[p.data.simpleData.idKey]+"",n)==-1?false:true});d.each(m,function(t,u){q.ztree.checkNode(u,true);s+=u[p.data.key.name]+p.separator;r+=u[p.data.simpleData.idKey]+p.separator});if(s.length>0){s=s.substring(0,s.length-1);r=r.substring(0,r.length-1)}this.$textBox.val(s).data("oldValue",r);this.$valueBox.val(r)}else{if(m.length>0){this.ztree.selectNode(m[0]);this.$valueBox.val(m[0][p.data.simpleData.idKey]);this.$textBox.val(m[0][p.data.key.name]).data("oldValue",m[0][p.data.simpleData.idKey])}}};i.prototype.processDate=function(){var n=this,m=this.options;if(m.rootElement){var o={};o[m.data.simpleData.idKey]=m.data.simpleData.rootPId;o[m.data.simpleData.pId]="";o.open=true;if(m.data.key.name){o[m.data.key.name]="全部";o.ISLEAF=0}this.datas.push(o)}d.each(this.datas,function(p,q){if(q.ISLEAF==0&&m.onlyLeaf){q.nocheck=true;return true}})};i.prototype.clear=function(){var m=this.ztree;d.each(m.getCheckedNodes(true),function(n,o){m.checkNode(o,!o.checked,null,true)});d.each(m.getSelectedNodes(),function(n,o){m.cancelSelectedNode(o,true)});this.$valueBox.val("");this.$textBox.val("");this.$textBox.data("oldValue","")};i.prototype.getData=function(){var m=this.ztree;return m.transformToArray(m.getNodes())};i.prototype.getTextById=function(q){var m,o=this,n=o.ztree,p=n.transformToArray(n.getNodes());d.each(p,function(r,s){if(s[o.options.data.simpleData.idKey]==q){m=s[o.options.data.key.name];return false}});return m};i.prototype.getTree=function(){return this.ztree};var j=f(g,{init:function(n,m){this.base(n,m);this.that_id=d(n).attr("id")!=null?d(n).attr("id"):"searchTree_"+new Date().getTime();this.initModal();this.initModalContent();this.datas;this.ztree;this.$tree;this.$modal;this.lastNode}});j.prototype.initModal=function(){var q=this,n=this.options,p=this.$textBox,m=this.that_id,o='<div><div class="modal fade" id="'+m+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+m+'_label" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="'+m+'_label">'+n.modalTitle+'</h4></div><div class="modal-body"></div><div class="modal-footer"><button type="button" class="btn btn-default" style="float:left" id="'+m+'_clear">清空</button><button type="button" class="btn btn-default" data-dismiss="modal">关闭</button><button type="button" class="btn btn-primary" id="'+m+'_modalok">确定</button></div></div></div></div><iframe frameborder= "0" scrolling="no" style="background-color:transparent; position:absolute; z-index: -1; width:100%; height:100%; top:0; left:0;"></iframe></div>';if(d("#"+m+"_modal")){d("#"+m+"_modal").remove()}d("body").append(o);this.$valueBox.attr("boxType","searchTree");p.removeAttr("name").removeAttr("dname").after('<i class="fa fa-angle-down combo-box-arrows"></i>');this.$modal=d("#"+m+"_modal").css("z-index",999999999);if(n.modalWidth!=="auto"){this.$modal.find(".modal-dialog").width(n.modalWidth)}if(n.modalHeight!=="auto"){this.$modal.find(".modal-dialog").height(n.modalHeight)}this.$modal.on("hidden.bs.modal",function(){if(n.required||n.validate){q.validate()}q.$tree.data("tree").searchNodes("");q.$modal.find(":text").val("");n.onCloseCallback.call(q,p)});if(n.editInput){p.siblings(".combo-box-arrows").attr({"data-target":"#"+m+"_modal","data-toggle":"modal"});p.on("input propertychange",function(){p.siblings(".valueBox").val(p.val())})}else{p.parent().attr({"data-target":"#"+m+"_modal","data-toggle":"modal"});p.attr({readonly:"true"})}p.removeAttr("name");p.parent().attr("style",this.$textBox.attr("style"));p.removeAttr("style").css({width:"100%"}).addClass("empty form-control").data("oldValue","");d("#"+m+"_modalok").on("click",function(){q.doclick()});d("#"+m+"_clear").on("click",function(){q.clear()})};j.prototype.doclick=function(){var q=this,o=this.options,r=q.$tree.tree("getValue"),n=q.$textBox.data("oldValue"),p=this.$textBox;if(n!=r){q.$valueBox.val(r);p.data("oldValue",r).val(q.$tree.tree("getText"));var m=q.ztree.getCheckedNodes(),s=m.length===1?m[0]:m;q.options.onChange.call(q,r,n,s);if(o.required||o.validate){q.validate()}}q.options.onAckCallback.call(q,q.$tree.tree("getTree").getCheckedNodes(),p);q.$modal.modal("hide")};j.prototype.initModalContent=function(){var q=this,m=this.that_id,p=this.$modal.find(".modal-body"),n=this.options;p.append('<ul id="'+m+'_mdTree" class="ztree searchTree"></ul>');this.$tree=d("#"+m+"_mdTree");q.$tree.wrap('<div class="treeWrap"></div>');q.$tree.parent().css({maxHeight:d(window).height()/2,overflowY:"auto"});var s=this.$modal.find(".treeWrap");this.$modal.on("shown.bs.modal",function(){s.prev().prev().focus()});this.$modal.on("show.bs.modal",function(){n.onClickInput.apply(q,[q.$textBox]);q.$tree.tree("setValue",q.$valueBox.val())});n.view.dblClickExpand=false;n.callback["beforeClick"]=function(u,t){try{q.lastNode=t;if(t.ISLEAF==0){q.$tree.tree("getTree").expandNode(t)}}catch(w){}return true};n.callback["beforeDblClick"]=function(u,t){if(!t){return false}q.$tree.tree("getTree").checkNode(t,true,true,true);q.doclick();return false};if(this.options.url!=""){d.dajax({url:n.url,data:n.queryParam,async:d.plugAsyncConfig||false,success:function(t){q.datas=t;o();n.localdata=t;n.url="";n.callback["beforeClick"]=function(w,u){try{q.lastNode=u;if(u.ISLEAF==0){q.ztree.expandNode(u)}}catch(x){}return true};n.callback["beforeDblClick"]=function(w,u){if(!u){return false}q.ztree.checkNode(u,true,true,true);q.doclick();return false};r();if(n.formInitCallBack!=null){n.formInitCallBack(n.name)}n.onLoaded.call(q.$tree,q.ztree)}})}else{if(this.options.localdata!=undefined){q.datas=this.options.localdata;o();r();n.onLoaded.call(q.$tree,q.ztree)}else{r();n.onLoaded.call(q.$tree,q.ztree)}}function o(){if(n.rootElement){var t={};t[n.data.simpleData.idKey]=n.data.simpleData.rootPId;t[n.data.simpleData.pId]="";t.open=true;if(n.data.key.name){t[n.data.key.name]="全部";t.ISLEAF=0}q.datas.push(t)}d.each(q.datas,function(u,w){w.chkDisabledInherit=true;if(w.ISLEAF==0&&!n.ISLEAF){w.nocheck=true;return true}if(this.ISLEAF=="0"){this.isParent=true}})}function r(){var t={onLoaded:function(x){}},w=d.extend({},n,t);q.$tree.tree(w);q.ztree=q.$tree.tree("getTree");var u=q.$valueBox.val()||n.defaultValue;q.setValue(u);q.$textBox.data("oldValue",u)}};j.prototype.readonly=function(){this.$textBox.attr({readonly:"readonly",disabled:false}).addClass("readonly").removeClass("bgwhite");if(this.options.editInput){this.$textBox.siblings(".combo-box-arrows").removeAttr("data-target")}else{this.$textBox.parent().removeAttr("data-target")}};j.prototype.disable=function(){this.$textBox.attr("disabled","disabled").removeClass("bgwhite");if(this.options.editInput){this.$textBox.siblings(".combo-box-arrows").removeAttr("data-target")}else{this.$textBox.parent().removeAttr("data-target")}};j.prototype.destroy=function(){this.$modal.remove();this.$outerBox.remove()};j.prototype.enable=function(){this.$textBox.removeAttr("disabled").addClass("bgwhite").removeClass("readonly");if(this.options.editInput){this.$textBox.siblings(".combo-box-arrows").attr("data-target","#"+this.that_id+"_modal")}else{this.$textBox.parent().attr("data-target","#"+this.that_id+"_modal")}};j.prototype.getText=function(){if(!!this.$valueBox.prop("disabled")){return false}return this.$textBox.val()};j.prototype.getTextById=function(m){return this.$tree.tree("getTextById",m)};j.prototype.setValue=function(m){if(this.ztree==null){return}this.$tree.tree("setValue",m);this.$textBox.val(this.$tree.tree("getText")).data("oldValue",this.$tree.tree("getValue"));this.$valueBox.val(this.$tree.tree("getValue"))};j.prototype.clear=function(){this.$tree.tree("clearTree");this.$textBox.data("oldValue","");this.$textBox.val("");this.$valueBox.val("")};j.prototype.reload=function(n){var m=this.$valueBox.val();this.$tree.tree("reload",n);this.setValue(m)};j.prototype.getTree=function(){return this.ztree};j.prototype.getData=function(){return this.$tree.tree("getData")};j.prototype.onTrigger=function(){};d.fn.searchTree=function(m){var p=d.replaceTag(d(this),"INPUT"),o=null;if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/bootstrap-zTree-custom.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js"]);d.include([__bootstrapVersionPath+"/css/font-awesome.min.css"]);o=p.data("searchTree");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.extend({},d.textBoxDefault,d.searchTreeDefault),m);p.data("searchTree",new j(p,m));p.data("type","searchTree");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("searchTree");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};var l=function(n,m){this.$tree=n;this.options=m;this.$searchBox;this.$outerBox;this.datas;this.ztree=null;this.initTree(n,m);this.initsearchBox()};d.fn.tree=function(m){var q=d.replaceTag(d(this),"UL");if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/zTreeStyle.css",__bootstrapVersionPath+"/plugins/tree/css/zTreeStyle/bootstrap-zTree-custom.css",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.all.min.js",__bootstrapVersionPath+"/plugins/tree/js/jquery.ztree.exhide.min.js"]);m=d.extend(true,{},d.treeDefault,m);var n=new l(q,m);q.data("tree",n);return}if(typeof m=="string"){var o,r=Array.prototype.slice.call(arguments,1),p=q.data("tree");o=p[m].apply(p,r);return typeof o==="undefined"?this:o}};l.prototype.getTree=function(){return this.ztree};l.prototype.getValue=function(){var p=this,o=p.ztree,m=o.getCheckedNodes(),q="",r=p.options.getValueField;if(p.options.openSearch){var n=o.getNodesByParam("isHidden",true);o.showNodes(n);m=o.getCheckedNodes();p.searchNodes(p.$searchBox.val())}d.each(m,function(s,t){if(r===""){q+=t[p.options.data.simpleData.idKey]+","}else{q+=t[r]+","}});if(q.length>0){q=q.substring(0,q.length-1)}return q};l.prototype.getText=function(){var m=this.ztree.getCheckedNodes(),n=this,o="";d.each(m,function(p,q){o+=q[n.options.data.key.name]+","});if(o.length>0){o=o.substring(0,o.length-1)}return o};l.prototype.getTextById=function(q){var m,o=this,n=o.ztree,p=n.transformToArray(n.getNodes());d.each(p,function(r,s){if(s[o.options.data.simpleData.idKey]==q){m=s[o.options.data.key.name];return false}});return m};l.prototype.initTree=function(){var r=this.$tree,n=this.options,q=this,p=r.attr("id")!=null?r.attr("id"):"tree_"+new Date().getTime();r.addClass("ztree").attr("id",p);if(n.checkType=="radio"){n.check.enable="true";n.check.chkStyle="radio";n.check.radioType="all"}else{if(n.checkType=="checkbox"){n.check.enable="true";n.check.chkStyle="checkbox"}else{if(n.checkType=="nocheck"){n.check.enable=false}}}n.callback.onClick=function(x,w,u,t){q.ztree.checkNode(u,null,false,false);q.options.callback.clickNode.call(q,x,w,u,t)};var m={fontCss:s};n.view=d.extend({},m,n.view);function s(u,t){return t.color!=null?{color:t.color}:{}}if(!!this.options.url){d.dajax({url:n.url,data:n.queryParam,async:d.plugAsyncConfig||false,success:function(t){q.datas=t;o();q.ztree=d.fn.zTree.init(r,n,t);if(n.formInitCallBack!=null){n.formInitCallBack(n.name)}n.onLoaded.call(r,q.ztree)}})}else{if(this.options.localdata!=undefined){q.datas=this.options.localdata;o();this.ztree=d.fn.zTree.init(r,n,n.localdata);n.onLoaded.call(r,q.ztree)}else{this.ztree=d.fn.zTree.init(r,n);n.onLoaded.call(r,q.ztree)}}function o(){if(n.rootElement){var t={};t[n.data.simpleData.idKey]=n.data.simpleData.rootPId;t[n.data.simpleData.pId]="";t.open=true;if(n.data.key.name){t[n.data.key.name]="全部";t.ISLEAF=0}q.datas.push(t)}d.each(q.datas,function(u,w){w.chkDisabledInherit=true;if(w.ISLEAF==0&&!n.ISLEAF){w.nocheck=true;return true}if(this.ISLEAF=="0"){this.isParent=true}})}if(n.outerHeight!=undefined){r.wrap('<div class="treeWrap"></div>');r.parent().css({height:n.outerHeight,overflowY:"auto"})}};l.prototype.initsearchBox=function(){var m=this.options,o=this.$tree,n=this;if(m.openSearch==true){if(!o.parent().hasClass("treeWrap")){o.wrap('<div class="treeWrap"></div>')}this.$outerBox=o.parent();this.$outerBox.wrap('<div class="treeOuter"></div>');this.$searchBox=d("<input/>").attr({type:"text",placeholder:m.searchPlaceholder?m.searchPlaceholder:"请输入关键字,按回车确认",id:o.attr("id")+"_searchBox"}).addClass("form-control input-sm tree_search").css("width","100%");this.$outerBox.before(this.$searchBox);this.$searchBox=this.$outerBox.prev(".tree_search");this.$searchIcon=d('<i class="glyphicon glyphicon-search tree_search_icon"></i>').insertAfter(n.$searchBox).on("click",function(){n.searchNodes(d.trim(n.$searchBox.val()))});this.$outerBox.css({height:this.options.outerHeight!==undefined?this.options.outerHeight-this.$searchBox.outerHeight():this.options.fixedTreeHeight,overflowY:"auto"});this.$searchBox.on("focus",function(){var r=n.$searchBox.parents(".modal");var p=[],q=[];var s=n.ztree;var t="",u="";n.$searchBox.on("keydown",function(w){if(w.which==13){if(n.options.openSearch&&n.options.dblEnterSearch){t=n.$searchBox.val();if(t!=u){p=n.searchNodes(d.trim(n.$searchBox.val()));if(p.length>0){q.splice(0,q.length);d.each(p,function(x){if(!p[x].nocheck){q.push(p[x])}})}u=t}else{if(q.length==1){s.checkNode(q[0],true,true);r.find("[id$='_modalok']").click()}}}else{n.searchNodes(d.trim(n.$searchBox.val()))}}})});this.$searchBox.on("blur",function(){n.$searchBox.off("keydown")})}};l.prototype.searchNodes=function(t){var r=this.options,o=this.ztree,n=[],m=o.transformToArray(o.getNodes()),q="";if(t==""){o.showNodes(m);return n}switch(r.searchAttr){case"name":q=r.data.key.name;break;case"id":q=r.data.simpleData.idKey;break;case"pId":q=r.data.simpleData.pIdKey;break;default:q=r.searchAttr}s(false);n=o.getNodesByParamFuzzy(q,t,null);s(true);return n;function s(u){o.hideNodes(m);for(var w=0;w<n.length;w++){p(o,n[w]);n[w].highlight=u;o.updateNode(n[w])}o.showNodes(n)}function p(u,x){u.expandNode(x,true,false,false);var w=x.getParentNode();if(w!=null){n.push(w);p(u,w)}}};l.prototype.clearTree=function(){var n=this.ztree,m=n.getCheckedNodes();n.cancelSelectedNode();d.each(m,function(o,p){n.checkNode(p,false,false,false)})};l.prototype.setValue=function(p){this.clearTree();var o=this,p=p+"",n=[],m=o.ztree.transformToArray(o.ztree.getNodes());if(p.indexOf(",")==-1){n[0]=p}else{n=p.split(",")}d.each(n,function(q,r){d.each(m,function(s,t){if(r==t[o.options.data.simpleData.idKey]){o.ztree.checkNode(t,null,false,false);o.ztree.selectNode(t,true);return true}})})};l.prototype.reload=function(m){this.ztree.destroy();this.options=d.extend({},this.options,m);this.initTree(this.$tree,this.options)};l.prototype.getData=function(){var m=this.ztree;return m.transformToArray(m.getNodes())};l.prototype.destroy=function(){var m=this.$tree;this.ztree.destroy();if(this.$searchBox!=undefined){this.$outerBox.remove()}else{m.remove()}};l.prototype.getCheckedNodes=function(m){if(m===undefined){m=true}return this.ztree.getCheckedNodes(m)};l.prototype.checkNode=function(o,n,p,m){this.ztree.checkNode(o,n,p,m)};l.prototype.checkAllNodes=function(m){if(m===undefined){m=true}this.ztree.checkAllNodes(m)};l.prototype.expandNode=function(p,q,o,m,n){return this.ztree.expandNode(p,q,o,m,n)};l.prototype.expandAll=function(m){if(m===undefined){m=true}return this.ztree.expandAll(m)};l.prototype.setChkDisabled=function(n,m,o,p){this.ztree.setChkDisabled(n,m,o,p)};var e=false;function f(n,p){if(typeof(n)==="object"){p=n;n=null}function o(){if(!e){if(n){this.baseprototype=n.prototype}this.init.apply(this,arguments)}}if(n){e=true;o.prototype=new n();o.prototype.constructor=o;e=false}for(var m in p){if(p.hasOwnProperty(m)){if(n&&typeof(p[m])==="function"&&typeof(o.prototype[m])==="function"){o.prototype[m]=(function(q,r){return function(){this.base=n.prototype[q];return r.apply(this,arguments)}})(m,p[m])}else{o.prototype[m]=p[m]}}}return o}var c=f(g,{init:function(n,m){this.base(n,m);this.initDecimal()}});d.fn.decimal=function(m){var p=d.replaceTag(d(this),"INPUT"),o=null;if(typeof m=="object"){o=p.data("decimal");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.textBoxDefault,d.decimalDefault,m);p.data("decimal",new c(p,m));p.data("type","decimal");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("decimal");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};c.prototype.initDecimal=function(){var q=this.$textBox,n=this.options,p=this;var m=(1/10).toFixed(n.decimalPlaces);q.attr({step:m}).css({width:"100%"});if(!!n.defaultValue){p.setValue(o(parseFloat(n.defaultValue)))}if(q.parent().siblings().is(".control-identify")){q.parent().siblings().remove()}if(n.labeltitle){if(n.labelbreadth==undefined){n.labelbreadth="100px"}q.parent().before('<label class="control-label control-identify" for="" style="width:'+n.labelbreadth+' ;line-height:30px;text-align:center;">'+n.labeltitle+"</label>");q.parent().parent().css("display","flex")}this.$valueBox.attr("boxType","decimal");q.on("blur",function(){if(q.data("oldValue")!==undefined){p.setValue(o(parseFloat(q.val())))}});q.on("input propertychange",function(){var r=q.val().substr(q.val().length-1,1),s=/^[0-9]+.?[0-9]*/;if(!s.test(r)){p.setValue(q.val().replace(/[^\-?\d.]/g,""))}});function o(s){var u=parseInt(n.decimalPlaces)+2;var t=parseFloat(s).toFixed(u);var r=(n.decimalPlaces>0)?(t.lastIndexOf(".")+(u-1)):(t.lastIndexOf(".")+(u-1)-1);return t.substring(0,r)}};var b=f({init:function(n,m){this.options=m;this.$textBox=d(n);this.$outerBox;this.$editor;this.that_id=d(n).attr("id")!=null?d(n).attr("id"):"txtEdt_"+new Date().getTime();this.initTextEditor()}});d.fn.textEditor=function(m){if(!m){m={}}var p=d.replaceTag(d(this),"TEXTAREA"),o=null;if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/ckeditor/ckeditor.js"]);o=p.data("textEditor");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.textEditorDefault,m);p.data("textEditor",new b(p,m));p.data("type","textEditor");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("textEditor");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};b.prototype.initTextEditor=function(){var p=this,n=p.options,m=p.that_id;p.$textBox.attr({id:m});p.$outerBox=p.$textBox.wrap('<div class="editorBox ztreeBox_inp ztreeBox_down"></div>').parent();p.$editor=CKEDITOR.replace(m,n);if(n.hoverTips&&n.hoverTips!==""){var o=d('<i class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-placement="top" title="'+n.hoverTips+'"></i>').prependTo(p.$outerBox);o.tooltip()}CKEDITOR.on("instanceReady",function(q){if(n.setDisabled){p.setDisabled(true)}if(n.setReadonly){p.readonly()}n.onLoaded.call(this,p);p.onTrigger()})};b.prototype.clear=function(){CKEDITOR.instances[this.that_id].setData("")};b.prototype.getValue=function(){if(!!this.$textBox.attr("disabled")){return false}return CKEDITOR.instances[this.that_id].getData()};b.prototype.setValue=function(m){CKEDITOR.instances[this.that_id].setData(m)};b.prototype.readonly=function(){this.$editor.setReadOnly(true)};b.prototype.disable=function(){this.readonly()};b.prototype.enable=function(){this.$editor.setReadOnly(false)};b.prototype.setDisabled=function(m){this.$editor.setReadOnly(m);if(m==true){this.$textBox.attr("disabled","disabled")}else{this.$textBox.removeAttr("disabled")}};b.prototype.setReadonly=function(m){this.$editor.setReadOnly(m)};b.prototype.destroy=function(){this.$textBox.parents(".editorBox").remove()};b.prototype.getText=function(){if(!!this.$textBox.attr("disabled")){return false}return CKEDITOR.instances[this.that_id].document.getBody().getText()};b.prototype.onTrigger=function(){var o=this,n=this.$textBox,m=this.$outerBox.find(".cke_wysiwyg_frame");d("body",m[0].contentWindow.document).off("blur").on("blur",function(q){o.$outerBox.removeClass("has-error");if(o.options.required||o.options.validate){var p=o.validate();if(!p){o.options.validFail.apply(this,[o.$textBox])}else{o.options.validSuccess.apply(this,[o.$textBox])}}})};b.prototype.validate=function(){var n=true,r=this,s=r.getValue(),o=this.options,q=this.$textBox;if(q.is(":disabled")||q.is(":hidden")){return n}if(o.required&&s==""){this.tips("该选项为必填",this.$outerBox);this.$outerBox.addClass("has-error");return false}if(typeof o.validate=="function"){var t=o.validate.apply(o,[r.getValue(),s,q]);if(t&&t.result==false){this.tips(t.msg,r.$outerBox);this.$outerBox.addClass("has-error");return t.result}}else{if(typeof o.validate=="string"){var p=o.validate.split("|"),m;d.each(p,function(u,w){n=d.globalValid[w].reg.test(s);m=d.globalValid[w].text;if(!n){return false}});if(!n){r.tips(m,r.$outerBox)}}}if(n){this.$outerBox.removeClass("has-error")}else{this.$outerBox.addClass("has-error")}return n};b.prototype.tips=function(n,m){layer.tips(n,m,{tipsMore:true,time:2000})};d.fn.webupload=function(m){var q=d.replaceTag(d(this),"DIV");if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/webuploader/webuploader.js",__bootstrapVersionPath+"/plugins/webuploader/webuploader.datanew.js",__bootstrapVersionPath+"/plugins/webuploader/webuploader.css",__bootstrapVersionPath+"/css/font-awesome.min.css"]);m=d.extend(true,{},WebUpload.DEFAULTS,m);var s;if(d(".uploader").length>0){s=setTimeout(function(){var t=new WebUpload(q,m);q.data("webupload",t);m.onLoaded.call(q,t);return t},0)}else{var p=new WebUpload(q,m);q.data("webupload",p);m.onLoaded.call(q,p);return p}}else{if(typeof m=="string"){var n,r=Array.prototype.slice.call(arguments,1),o=q.data("webupload");n=o[m].apply(o,r);return typeof n==="undefined"?this:n}}};d.fn.iconBox=function(m){var p=d.replaceTag(d(this),"BUTTON"),o=null;if(!m){m={}}if(typeof m=="object"){d.include([__bootstrapVersionPath+"/plugins/iconBox/iconBox.css",__bootstrapVersionPath+"/plugins/iconBox/iconBox.js"]);o=p.data("iconBox");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.iconBoxDefault,m);p.data("iconBox",new IconBox(p,m));p.data("type","iconBox");return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("iconBox");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}};d.fn.radioBox=function(m){var p=d.replaceTag(d(this),"DIV"),o=null;if(!m){m={}}if(typeof m=="object"){d.include([__bootstrapVersionPath+"/css/font-awesome.min.css",__bootstrapVersionPath+"/plugins/radioBox/radioBox.css",__bootstrapVersionPath+"/plugins/radioBox/radioBox.js"]);o=p.data("radioBox");if(o!=null){o.options=d.extend({},o.options,m);return}m=d.extend({},d.radioBoxDefault,m);p.data("radioBox",new RadioBox(p,m));p.data("type","radioBox");m.onLoaded.call(this,p);return}if(typeof m=="string"){var n,q=Array.prototype.slice.call(arguments,1),o=p.data("radioBox");n=o[m].apply(o,q);return typeof n==="undefined"?this:n}}})(jQuery);