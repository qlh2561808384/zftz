var newNodes=[{id:1,pId:0,name:"节点1",ISLEAF:0,open:true},{id:11,pId:1,name:"节点1-1",ISLEAF:1},{id:12,pId:1,name:"节点1-2",ISLEAF:1},{id:2,pId:0,name:"节点2",ISLEAF:0,open:true},{id:21,pId:2,name:"节点2-1",ISLEAF:1}];function openOptions(t){var searchbar=[{rownum:3,inputs:[{title:"姓名",name:"name",type:"textBox",placeholder:"输入姓名"},{title:"test",name:"test",type:"comboBox",localdata:[{guid:1,postaccount:"test"}],valueField:"guid",textField:"postaccount",searchOption:true},{type:"searchTree",title:"ceshi",name:"searchtree",localdata:zNodes,ISLEAF:false,modalTitle:"查找名称",checkType:"checkbox"}]}];var searchbar=JSON.stringify(searchbar);var singleSelectToolBar=[{name:"新增",classes:"btn bootstrap-table-add",type:"button",onclick:"add()"},{name:"编辑",classes:"btn bootstrap-table-edit",type:"button",onclick:"edit()"},{name:"删除",classes:"btn bootstrap-table-delete test",type:"button",onclick:"remov()"}];var toolbar=JSON.stringify(singleSelectToolBar);var plugObj=$(t).parent().siblings(".view").find("[dtype]"),plugObjId=plugObj.attr("id"),dtype=plugObj.attr("dtype"),$view=$(t).parent().siblings(".view"),$sideTree=$("#sideTree"),nodeArr=$sideTree.tree("getTree").getNodesByParam("dragId",plugObjId),optionsFormId="optionsForm",defaultTreeData="./example/json/treeData.json";var $localdata=$("#sideTree").tree("getTree").setting.localdata;var optionsFormObj=$("#"+optionsFormId);optionsFormObj.attr("did",plugObjId);if(dtype==="tree"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基础属性",name:"",type:"title",colspan:"2"},{title:"树的高度，超出部分滚动",name:"outerHeight",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否加“全部”",name:"rootElement",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"父节点是否可选",name:"ISLEAF",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"选择框类型",name:"checkType",type:"comboBox",localdata:[{id:"radio",text:"radio"},{id:"checkbox",text:"checkbox"}],defaultValue:"radio",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"搜索框",type:"title",colspan:"2"},{title:"是否显示搜索框",name:"openSearch",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"fixedTreeHeight",title:"搜索框显示时，树的高度",type:"textBox",placeholder:"固定树的高度,让输入框显示在顶部",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"查询栏查询字符串占位符",name:"searchPlaceholder",type:" textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"配置属性模糊查询",name:"searchAttr",type:" textBox",placeholder:"配置的属性",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"DATA",type:"title",colspan:"2",},{title:"data.key.name",name:"name",type:"textBox",placeholder:"name",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.idKey",name:"idKey",type:"textBox",placeholder:"id",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.pIdKey",name:"pIdKey",type:"textBox",placeholder:"pId",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.rootPId",name:"rootPId",type:"textBox",placeholder:"0",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数据方式",name:"dataMethod",id:"tree-dataMethod",type:"comboBox",localdata:[{id:0,text:"url"},{id:1,text:"localdata"}],defaultValue:"url",colspan:2/3,onChange:function(newValue,oldValue){if(newValue==0){$("#treeData-url").textBox("enable");$("#treeData-localdata").textBox("disable")}else{if(newValue==1){$("#treeData-localdata").textBox("enable");$("#treeData-url").textBox("disable")}}}},{title:"远程数据url",name:"url",id:"treeData-url",type:"textBox",colspan:2/3,placeholder:defaultTreeData,defaultValue:defaultTreeData},{title:"远程请求所携带的参数",type:"textBox",name:"queryParam",placeholder:'{"id":xxx,"name":"xxxxxxx"}',onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:"2"},{title:"本地数据",name:"localdata",id:"treeData-localdata",type:"textBox",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="comboTree"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"下拉面板高度",name:"panelHeight",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否多选",name:"multiple",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue==0){$("#treeData-checkType").comboBox("enable")}else{if(newValue==1){$("#treeData-checkType").comboBox("disable");$("#treeData-checkType").val("checkBox")}}if(newValue!=oldValue){change()}}},{title:"父节点是否不可选",name:"onlyLeaf",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否加“全部”",name:"rootElement",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"选择框类型",name:"checkType",id:"treeData-checkType",type:"comboBox",localdata:[{id:"radio",text:"radio"},{id:"checkbox",text:"checkbox"}],defaultValue:"radio",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"DATA",type:"title",multiline:true,colspan:"2"},{title:"data.key.name",name:"name",type:"textBox",placeholder:"name",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.key.title",name:"title",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.key.url",name:"dataurl",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.idKey",name:"idKey",type:"textBox",placeholder:"id",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.pIdKey",name:"pIdKey",type:"textBox",placeholder:"pId",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.rootPId",name:"rootPId",type:"textBox",placeholder:"0",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数据方式",name:"dataMethod",id:"tree-dataMethod",type:"comboBox",localdata:[{id:0,text:"url"},{id:1,text:"localdata"}],defaultValue:"url",colspan:2/3,onChange:function(newValue,oldValue){if(newValue==0){$("#treeData-url").textBox("enable");$("#treeData-localdata").textBox("disable")}else{if(newValue==1){$("#treeData-localdata").textBox("enable");$("#treeData-url").textBox("disable")}}change()}},{title:"远程数据",name:"url",id:"treeData-url",type:"textBox",colspan:2/3,placeholder:defaultTreeData,defaultValue:defaultTreeData,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"远程请求所携带的参数",type:"textBox",name:"queryParam",placeholder:"{param1:xxx,param2:xx}",colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"本地数据",name:"localdata",id:"treeData-localdata",type:"textBox",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="searchTree"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"模态框标题",name:"modalTitle",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"模态框宽度",name:"modalWidth",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"模态框高度",name:"modalHeight",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否可直接输入",name:"editInput",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"提示文字",name:"placeholder",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否加“全部”",name:"rootElement",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"父节点是否可选",name:"ISLEAF",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"选择框类型",name:"checkType",type:"comboBox",localdata:[{id:"radio",text:"radio"},{id:"checkbox",text:"checkbox"}],defaultValue:"radio",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"DATA",type:"title",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.key.name",name:"name",type:"textBox",placeholder:"name",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.idKey",name:"idKey",type:"textBox",placeholder:"id",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.pIdKey",name:"pIdKey",type:"textBox",placeholder:"pId",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"data.simpleData.rootPId",name:"rootPId",type:"textBox",placeholder:"0",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数据方式",name:"dataMethod",id:"tree-dataMethod",type:"comboBox",localdata:[{id:0,text:"url"},{id:1,text:"localdata"}],defaultValue:"url",colspan:2/3,onChange:function(newValue,oldValue){if(newValue==0){$("#treeData-url").textBox("enable");$("#treeData-localdata").textBox("disable")}else{if(newValue==1){$("#treeData-localdata").textBox("enable");$("#treeData-url").textBox("disable")}}change()}},{title:"远程数据url",name:"url",id:"treeData-url",type:"textBox",colspan:2/3,placeholder:defaultTreeData,defaultValue:defaultTreeData,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"远程请求的额外参数",name:"queryParam",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"本地数据localdata",name:"localdata",id:"treeData-localdata",type:"textBox",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="textBox"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"宽度",name:"width",type:"textBox",placeholder:"100%",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"默认值",name:"defaultValue",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"提示信息",name:"placeholder",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否多选",name:"multiline",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数字按'1,234,567'格式",name:"thousandsNum",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否必选",name:"required",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},]})}else{if(dtype==="dateBox"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"宽度",name:"width",type:"textBox",placeholder:"100%",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"提示文字",name:"placeholder",type:"textBox",placeholder:"设置提示文字",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"默认值",name:"defaultValue",type:"textBox",placeholder:"默认值",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"面板范围选择",name:"range",type:"textBox",placeholder:"需跟日期格式/时间范围结合使用",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"最小范围内的日期时间值",name:"min",type:"textBox",placeholder:"格式 年-月-日",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"最大范围内的日期时间值",name:"max",type:"textBox",placeholder:"格式 年-月-日",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"层叠顺序",name:"zIndex",type:"textBox",placeholder:"默认为 66666666",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"标注重要日子",name:"mark",type:"textBox",placeholder:"{'0-10-14': '每年生日','2017-8-15': '具体日期'}",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"控件默认显示位置",name:"show",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"工具按钮",name:"btns",type:"textBox",placeholder:"['clear', 'now', 'confirm']",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否显示底部栏",name:"showBottom",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"},],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"日期格式",name:"format",type:"comboBox",localdata:[{id:"yyyy-mm-dd",text:"年-月-日"},{id:"mm-dd",text:"月-日"},{id:"hh-ii-ss",text:"时-分-秒"},],defaultValue:"yyyy-mm-dd",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否必选",name:"required",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"最精确的时间选择视图",name:"minView",id:"treeData-minView",type:"comboBox",localdata:[{id:0,text:"0/年月日时间"},{id:1,text:"1/年月日时间"},{id:2,text:"2/年月日"},{id:3,text:"3/年月"},{id:4,text:"4/年"},],defaultValue:"0/hour",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="comboBox"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"input宽度",name:"width",type:"textBox",placeholder:"100%",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"默认选中",name:"selected",type:"textBox",placeholder:"0",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"默认值",name:"defaultValue",type:"textBox",placeholder:"''",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否添加'全部'",name:"searchOption",type:"comboBox",localdata:[{id:"2",text:"null"},{id:"1",text:"true"},{id:"0",text:"false"}],defaultValue:"null",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否必选",name:"required",type:"comboBox",localdata:[{id:"1",text:"true"},{id:"0",text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"下拉面板宽度",name:"panelWidth",type:"textBox",placeholder:"auto",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"下拉面板高度",name:"panelHeight",type:"textBox",placeholder:"auto",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"取值字段名",name:"valueField",type:"textBox",placeholder:"id",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示文本字段名",name:"textField",type:"textBox",placeholder:"text",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否显示下拉按钮",name:"hasDownArrow",type:"comboBox",localdata:[{id:"1",text:"true"},{id:"0",text:"false"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"分隔符separator",name:"separator",type:"textBox",placeholder:",",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否多选",name:"multiple",type:"comboBox",localdata:[{id:"1",text:"true"},{id:"0",text:"false"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数据方式",type:"title",multiline:true,colspan:"2"},{title:"远程数据地址",name:"url",type:"textBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"本地数据",name:"localdata",type:"textBox",multiline:true,colspan:"2",defaultvalue:comboBoxDataStr,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="decimal"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"小数位数decimalPlaces",name:"decimalPlaces",type:"textBox",defaultValue:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="dtable"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{name:"",type:"title",title:"基础属性",multiline:true,colspan:2,},{title:"表格高度",name:"height",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"无数据显示",name:"undefinedText",type:"textBox",placeholder:"-",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否隔行变色",name:"striped",type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"flase"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"单元格手动拉伸",name:"resizable",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"点击行时，自动选择选框",name:"clickToSelect",type:"comboBox",localdata:[{id:false,text:"false"},{id:true,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"在列头隐藏选择框",name:"checkboxHeader",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"启用列拖拽",name:"ifDrag",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"禁止多选",name:"singleSelect",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置列数",name:"minimumCountColumns",type:"textBox",defaultValue:"1",placeholder:"列数小于时，隐藏内容可下拉",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"是否显示 数据条数",name:"showPaginationSwitch",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"radio/checkbox字段名",name:"selectItemName",type:"textBox",placeholder:"默认为btSelectItem",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"转义HTML字符串",name:"escape",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示/隐藏",name:"",type:"title",multiline:true,colspan:2,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示 刷新按钮",name:"showRefresh",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示 内容列下拉框",name:"showColumns",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示页脚",name:"showFooter",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示列头",name:"showHeader",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"切换(table/card)按钮",name:"showToggle",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"详细页面模式",name:"detailView",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"使用于移动端",name:"cardView",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"智能显示分页或卡片视图",name:"smartDisplay",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"自定义工具类",name:"toolbar",type:"textBox",placeholder:toolbar,multiline:true,colspan:2,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"分页",name:"",type:"title",multiline:true,colspan:2,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置分页方式 后台/本地",name:"sidePagination",type:"comboBox",localdata:[{id:"client",text:"client"},{id:"server",text:"server"}],defaultValue:"client",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"contentType",title:"数据编码类型",type:"textBox",placeholder:"默认为application/json",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"dataType",title:"返回的数据类型",placeholder:"默认为json",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"数据请求方式",name:"method",type:"comboBox",localdata:[{id:"get",text:"get"},{id:"post",text:"post"}],defaultValue:"get",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"禁用 AJAX 数据缓存",name:"cache",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"远程数据",name:"url",type:"textBox",placeholder:"当分页方式为后台时必须设置",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"排序方式 后台/本地",name:"sortModel",type:"comboBox",localdata:[{id:"client",text:"client"},{id:"server",text:"server"}],defaultValue:"client",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置首页页码",name:"pageNumber",type:"textBox",placeholder:"默认为1",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"页面数据条数",name:"pageSize",type:"textBox",placeholder:" 默认为10条",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置可选择的页面数据数",name:"pageList",type:"textBox",placeholder:"[10, 25, 50, 100, all]",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"表格底部显示分页条",name:"pagination",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"启用分页条无限循环",name:"paginationLoop",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"true",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"显示分页跳转到指定页码",name:"showJumpto",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"不显示分页按钮",name:"onlyInfoPagination",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"}],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"自动刷新",name:"autoRefreshTime",type:"textBox",placeholder:"默认false,单位毫秒",defaultValue:false,colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"列配置项",name:"columns",type:"textBox",multiline:true,colspan:2,defaultvalue:tableColStr,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"本地数据data",name:"data",type:"textBox",multiline:true,colspan:2,defaultvalue:tableDataStr,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"",type:"title",title:"搜索框",colspan:2},{title:"搜索栏表单列数",name:"dtableColNum",type:"textBox",colspan:2,multiline:true,defaultValue:0,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"输入内容",name:"dtableInputs",type:"textBox",colspan:2,multiline:true,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"搜索框位置",name:"searchAlign",type:"comboBox",localdata:[{id:"left",text:"left"},{id:"right",text:"right"}],defaultValue:"left",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"",type:"title",title:"其他配置项",colspan:2},{title:"exportExcel",name:"exportExcel",type:"textBox",colspan:2,placeholder:'{fileName:"文件名", tableStyle:"表格样式 默认空", fileEncode:"UTF-8"}',onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"detailFormatter",type:"textBox",colspan:2,title:"格式化详细页面模式视图",defaultValue:"",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"responseHandler",type:"textBox",title:"用来格式化数据。",defaultValue:"",placeholder:"加载服务器数据前",colspan:2,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"queryParams",type:"textBox",defaultValue:"",colspan:2,title:"重写参数添加额外的参数",placeholder:"function(params) { return params; }",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{name:"ajax",type:"textBox",defaultValue:"",colspan:2,title:"自定义AJAX方法",placeholder:"须实现 jQuery AJAX API",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="dform"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"表单标题",name:"formtitle",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"每行控件数目",name:"rownum",type:"textBox",placeholder:3,colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"标签宽度",name:"labelwidth",type:"textBox",placeholder:"50px",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"标题显示的位置",name:"showtitle",type:"comboBox",localdata:[{id:"left",text:"left"},{id:"top",text:"top"},{id:"none",text:"none"}],defaultValue:"left",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"标签显示位置",name:"labelAlign",type:"comboBox",localdata:[{id:"left",text:"left"},{id:"right",text:"right"},{id:"center",text:"center"}],defaultValue:"left",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置为只读",name:"setReadonly",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置为禁用",name:"setDisabled",type:"comboBox",localdata:[{id:0,text:"false"},{id:1,text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"组件数组",name:"inputs",type:"textBox",multiline:true,colspan:"2",defaultvalue:formInputsStr,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="dbutton"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"基本属性",type:"title",multiline:true,colspan:"2"},{title:"按钮文本",name:"text",type:"textBox",defulatVaule:"按钮",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"按钮样式",name:"type",type:"comboBox",localdata:[{id:"default",text:"白色"},{id:"primary",text:"蓝色"},{id:"success",text:"绿色"},{id:"info",text:"湖蓝"},{id:"warning",text:"橙色"},{id:"danger",text:"红色"}],defulatVaule:"白色",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"字体大小",name:"size",type:"comboBox",localdata:[{id:"lg",text:"大号"},{id:"sm",text:"小号"},{id:"xs",text:"超小"},{id:"block",text:"行级"}],colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"图标",name:"icon",type:"textBox",colspan:"2",placeholder:"可使用bootatrap glyphicon文字图标 也支持自定义样式",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}}]})}else{if(dtype==="webupload"){optionsFormObj.dform({rownum:2,labelwidth:"200px",inputs:[{title:"原有属性",type:"title",multiline:true,colspan:"2"},{title:"文件提交路径",name:"server",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"缩略图宽度",name:"thumbnailWidth",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"缩略图高度",name:"thumbnailHeight",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"有文件选择即开始上传",name:"auto",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"指定运行时启动顺序",name:"runtimeOrder",type:"textBox",placeholder:"默认为{html5,flash}",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"提前准备好下个传输文件",name:"prepareNextFile",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"分片处理大文件上传",name:"chunked",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},defaultValue:"false",colspan:2/3},{title:"如果要分片,分多大",name:"chunkSize",type:"textBox",placeholder:"默认为5m",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"分片出错,允许自动重传",name:"chunkRetry",type:"textBox",placeholder:"默认2次",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"允许同时最大上传进程数",name:"threads",type:"textBox",placeholder:"默认3",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"文件上传请求的参数表",name:"formData",type:"textBox",placeholder:"",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"设置文件上传域的name",name:"fileVal",type:"textBox",placeholder:"",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"文件上传方式",name:"method",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"以二进制的流的方式发送",name:"sendAsBinary",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],defaultValue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"验证文件总数量",name:"fileNumLimit",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"验证文件总大小",name:"fileSizeLimit",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"验证单个文件大小",name:"fileSingleSizeLimit",type:"textBox",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"文件名去重",name:"duplicate",type:"comboBox",localdata:[{id:"0",text:"false"},{id:"1",text:"true"},],defaultvalue:"false",colspan:2/3,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"onExceedFileNum",name:"onExceedFileNum",type:"textBox",colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"disableWidgets",name:"disableWidgets",type:"textBox",placeholder:"默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单",colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}}},{title:"指定选择文件的按钮容器，不指定则不创建按钮",name:"pick",type:"textBox",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},placeholder:'{\n    id: ".filePicker", //{Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。注意 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点\n    label: "", //{String} 请采用 innerHTML 代替\n    innerHTML: "点击选择文件", //{String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n    multiple: true/false //{Boolean} 是否开起同时选择多个文件能力。\n}\n'},{title:"指定接受哪些类型的文件",name:"accept",type:"textBox",multiline:true,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:"2",placeholder:'{\n    title : "Image",//{String} 文字描述\n    extensions: "gif,jpg,jpeg,bmp,png" //{String} 允许的文件后缀，不带点，多个用逗号分割 \n    mimeTypes: "image/*" //{String} 多个用逗号分割\n}\n'},{title:"配置生成缩略图的选项",name:"thumb",type:"textBox",multiline:true,onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:"2",placeholder:"{\n    width: 110,\n    height: 110,\n    quality: 70, //图片质量，只有type为'image/jpeg'的时候才有效\n    allowMagnify: true, //是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false\n    crop: true, //是否允许裁剪\n    type: 'image/jpeg' //为空的话则保留原有图片格式。否则强制转换成指定的类型\n}\n"},{title:"配置压缩的图片的选项。如果此选项为false, 则图片在上传前不进行压缩",name:"compress",type:"textBox",multiline:true,colspan:"2",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},placeholder:"{\n    width: 1600,\n    height: 1600,\n    quality: 90, //图片质量，只有type为'image/jpeg'的时候才有效\n    allowMagnify: false, //是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false\n    crop: false, //是否允许裁剪\n    preserveHeaders: true, //是否保留头部meta信息\n    noCompressIfLarger: false, //如果发现压缩后文件大小比原来还大，则使用原来图片.此属性可能会影响图片自动纠正功能\n    compressSize: 0 //单位字节，如果图片大小小于此值，不会采用压缩。\n}\n"},{title:"新增属性",type:"title",multiline:true,colspan:"2"},{title:"是否显示删除按钮",name:"isDel",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},type:"comboBox",localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"true",colspan:2/3},{title:"是否显示下载按钮",name:"isDownload",type:"comboBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},localdata:[{id:1,text:"true"},{id:0,text:"false"}],defaultValue:"true",colspan:2/3},{title:"默认视图",name:"defaultView",type:"comboBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},localdata:[{id:"bigPic",text:"大图展示"},{id:"detailList",text:"列表展示"}],defaultValue:"大图展示",colspan:2/3},{title:"已提交的文件信息",name:"dataUrl",type:"textBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:2/3},{title:"用于删除文件",name:"delUrl",type:"textBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:2/3},{title:"用于下载文件",name:"downloadUrl",type:"textBox",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:2/3},{title:"上传返回用于保存文件id",name:"fileIdKey",type:"textBox",placehoder:"fileId",onChange:function(newValue,oldValue){if(newValue!=oldValue){change()}},colspan:2}]})}}}}}}}}}}}if(dtype){if(dtype.toLowerCase().indexOf("tree")!==-1){if($("#tree-dataMethod").comboBox("getValue")==="localdata"){$("#treeData-url").textBox("disable");$("#treeData-localdata").textBox("enable")}else{$("#treeData-url").textBox("enable");$("#treeData-localdata").textBox("disable")}}}$(".setOptionsForm").show();if(nodeArr[0]&&nodeArr[0].dragAll){$.each(nodeArr[0].dragAll,function(i,n){if(i==="localdata"||i==="columns"||i==="data"||i==="inputs"||i==="queryParam"||i==="btns"||i==="mark"){nodeArr[0].dragAll[i]=JSON.stringify(n)}});optionsFormObj.dform("load",nodeArr[0].dragAll);$.each(nodeArr[0].dragAll,function(i,n){if(i==="localdata"||i==="columns"||i==="data"||i==="inputs"||i==="queryParam"||i==="btns"||i==="mark"){nodeArr[0].dragAll[i]=JSON.parse(n)}})}$(".setOptionsForm").on("click",".layui-layer-btn1",function(){$(".setOptionsForm").hide()});$(".setOptionsForm").on("click",".layui-layer-btn0",function(){var plugOptions=$("#"+optionsFormId).dform("getData");$.each(plugOptions,function(key,val){if(val===""){delete plugOptions[key]}else{if(val==="1"||val==="0"){plugOptions[key]=parseInt(val)}}});$.each(plugOptions,function(i,n){if(n!==undefined&&(i==="localdata"||i==="columns"||i==="data"||i==="inputs"||i==="queryParam"||i==="btns"||i==="mark")){try{plugOptions[i]=eval("("+plugOptions[i]+")")}catch(e){throw new Error("对象字符串异常")}}});if(dtype.toLowerCase().indexOf("tree")!==-1){plugOptions.data={};var keyArr=["checked","name"];var simpleDataArr=["enable","idKey","pIdKey","rootPId"];var dataArr=[keyArr,simpleDataArr];var dataTypeArr=["key","simpleData"];$.each(dataArr,function(i,n){var dataType=dataTypeArr[i];$.each(dataArr[i],function(j,m){var dataVal=dataArr[i][j];if(plugOptions[dataVal]!==undefined){if(plugOptions.data[dataType]===undefined){plugOptions.data[dataType]={}}plugOptions.data[dataType][dataVal]=plugOptions[dataVal];delete plugOptions[dataVal]}})});if(Object.keys(plugOptions.data).length===0){delete plugOptions.data}}var plugOptionsClone=cloneObj(plugOptions);$.each(plugOptionsClone,function(key,val){if(dtype.toLowerCase().indexOf("tree")!==-1){if(parseInt(plugOptionsClone.dataMethod)!==1){delete nodeArr[0].dragAll.localdata;delete plugOptionsClone.localdata}else{delete nodeArr[0].dragAll.url;delete plugOptionsClone.url}}nodeArr[0].dragAll[key]=plugOptionsClone[key]});var $length=$localdata.length;for(var i=0;i<$length;i++){if(nodeArr[0].dragId==$localdata[i].dragId){$localdata[i]=nodeArr[0]}}$sideTree.tree("getTree").updateNode(nodeArr[0]);$("#sideTree").empty().tree({localdata:$localdata,checkType:"nocheck",data:{key:{children:"plug",name:"dragName"},simpleData:{idKey:"dragId",pIdKey:"dragPId"}},onLoaded:function(ztree){ztree.expandAll(true)}});if(optionsFormObj.attr("did")==plugObjId){$view.html('<input class="layoutClass" id="'+plugObjId+'" dtype="'+dtype+'">');plugObj=$view.find("[dtype="+dtype+"]");plugObj[dtype](plugOptions)}$(".setOptionsForm").hide()})}function change(){var did=$("#optionsForm").attr("did");var plugObj=$("#"+did),plugObjId=plugObj.attr("id"),dtype=plugObj.attr("dtype"),$view=$("#"+did).parents(".view")[0],$sideTree=$("#sideTree"),nodeArr=$sideTree.tree("getTree").getNodesByParam("dragId",plugObjId),optionsFormId="optionsForm",defaultTreeData="./example/json/treeData.json";var $localdata=$("#sideTree").tree("getTree").setting.localdata;var plugOptions=$("#"+optionsFormId).dform("getData");$.each(plugOptions,function(key,val){if(val===""){delete plugOptions[key]}else{if(val==="1"||val==="0"){plugOptions[key]=parseInt(val)}}});$.each(plugOptions,function(i,n){if(n!==undefined&&(i==="localdata"||i==="columns"||i==="data"||i==="inputs"||i==="queryParam"||i==="btns"||i==="mark")){try{plugOptions[i]=eval("("+plugOptions[i]+")")}catch(e){throw new Error("对象字符串异常")}}});if(dtype.toLowerCase().indexOf("tree")!==-1){plugOptions.data={};var keyArr=["checked","name"];var simpleDataArr=["enable","idKey","pIdKey","rootPId"];var dataArr=[keyArr,simpleDataArr];var dataTypeArr=["key","simpleData"];$.each(dataArr,function(i,n){var dataType=dataTypeArr[i];$.each(dataArr[i],function(j,m){var dataVal=dataArr[i][j];if(plugOptions[dataVal]!==undefined){if(plugOptions.data[dataType]===undefined){plugOptions.data[dataType]={}}plugOptions.data[dataType][dataVal]=plugOptions[dataVal];delete plugOptions[dataVal]}})});if(Object.keys(plugOptions.data).length===0){delete plugOptions.data}}var plugOptionsClone=cloneObj(plugOptions);$.each(plugOptionsClone,function(key,val){if(dtype.toLowerCase().indexOf("tree")!==-1){if(parseInt(plugOptionsClone.dataMethod)!==1){delete nodeArr[0].dragAll.localdata;delete plugOptionsClone.localdata}else{delete nodeArr[0].dragAll.url;delete plugOptionsClone.url}}nodeArr[0].dragAll[key]=plugOptionsClone[key]});var $length=$localdata.length;for(var i=0;i<$length;i++){if(nodeArr[0].dragId==$localdata[i].dragId){$localdata[i]=nodeArr[0]}}$sideTree.tree("getTree").updateNode(nodeArr[0]);$("#sideTree").empty().tree({localdata:$localdata,checkType:"nocheck",data:{key:{children:"plug",name:"dragName"},simpleData:{idKey:"dragId",pIdKey:"dragPId"}},onLoaded:function(ztree){ztree.expandAll(true)}});$($view).html('<input class="layoutClass" id="'+plugObjId+'" dtype="'+dtype+'">');plugObj=$($view).find("[dtype="+dtype+"]");plugObj[dtype](plugOptions);var dclass="layoutClass";$("#sideTree li a").each(function(i){$(this).on("click",function(){if(i==0){$(".main").addClass("layout_tree_focus");$(".main").find("."+dclass).removeClass("layout_tree_focus")}else{$(".main").removeClass("layout_tree_focus");var $dom=$(".main").find("."+dclass).removeClass("layout_tree_focus").eq(i-1);var oldDOM=$(".main").find("."+dclass);var length=oldDOM.length;for(var t=0;t<length;t++){if($(oldDOM[t]).attr("dtype")==undefined){oldDOM.splice(t,1);length--}}if($dom.attr("dtype")!="column"&&$dom.attr("dtype")!="row"&&$dom.attr("dtype")!="container"){var target=$(oldDOM.eq(i-1).parents(".view")[0]).siblings(".configuration").find("button");openOptions(target);$(t).parent().siblings(".view")}else{$(".setOptionsForm").hide()}oldDOM.removeClass("layout_tree_focus").eq(i-1).addClass("layout_tree_focus")}})})}function formDate(optionsFormId,dtype){var plugOptions=$("#"+optionsFormId).dform("getData");$.each(plugOptions,function(key,val){if(val===""){delete plugOptions[key]}else{if(val==="1"||val==="0"){plugOptions[key]=parseInt(val)}}});$.each(plugOptions,function(i,n){if(n!==undefined&&(i==="localdata"||i==="columns"||i==="data"||i==="inputs"||i==="queryParam"||i==="btns"||i==="mark")){try{plugOptions[i]=eval("("+plugOptions[i]+")")}catch(e){throw new Error("对象字符串异常")}}});if(dtype.toLowerCase().indexOf("tree")!==-1){plugOptions.data={};var keyArr=["checked","name"];var simpleDataArr=["enable","idKey","pIdKey","rootPId"];var dataArr=[keyArr,simpleDataArr];var dataTypeArr=["key","simpleData"];$.each(dataArr,function(i,n){var dataType=dataTypeArr[i];$.each(dataArr[i],function(j,m){var dataVal=dataArr[i][j];if(plugOptions[dataVal]!==undefined){if(plugOptions.data[dataType]===undefined){plugOptions.data[dataType]={}}plugOptions.data[dataType][dataVal]=plugOptions[dataVal];delete plugOptions[dataVal]}})});if(Object.keys(plugOptions.data).length===0){delete plugOptions.data}}var plugOptionsClone=cloneObj(plugOptions);$.each(plugOptionsClone,function(key,val){if(dtype.toLowerCase().indexOf("tree")!==-1){if(parseInt(plugOptionsClone.dataMethod)!==1){delete nodeArr[0].dragAll.localdata;delete plugOptionsClone.localdata}else{delete nodeArr[0].dragAll.url;delete plugOptionsClone.url}}nodeArr[0].dragAll[key]=plugOptionsClone[key]})}function openFormOptions(i){var d=$(i).parent().siblings(".view").children("[dtype]"),c=d.attr("id"),j=d.attr("dtype"),g=$(i).parent().siblings(".view"),a=$("#sideTree"),b=a.tree("getTree").getNodesByParam("dragId",c),h="optionsForm",e;$.dopen({btn:["保存","取消"],type:1,area:["900px","500px"],colseBtn:1,fix:true,title:"属性配置",content:'<form id="'+h+'"></form>',btn1:function(m){var l=$("#"+h).dform("getData");$.each(l,function(n,o){if(o==""){delete l[n]}else{if(o=="1"||o=="0"){l[n]=parseInt(o)}}});$.each(l,function(n,o){b[0].dragAll[n]=l[n]});var k=cloneObj(b[0].plug);b[0].plug=processForm(k);b[0].dragAll.inputs=cloneObj(b[0].plug);delete b[0].plug;a.tree("getTree").updateNode(b[0]);initContainer();layer.close(m)},btn2:function(k){layer.close(k)}});var f=$("#"+h);f.dform({rownum:2,labelwidth:"200px",inputs:[{title:"表单标题formtitle",name:"formtitle",type:"textBox"},{title:"标签宽度labelwidth",name:"labelwidth",type:"textBox",defaultValue:"50px"},{title:"form总控件数totalnum",name:"totalnum",type:"textBox",defaultValue:3},{title:"每行控件数目rownum",name:"rownum",type:"textBox",defaultValue:3},{title:"组件数组inputs",name:"inputs",type:"textBox",multiline:true,colspan:2,defaultValue:JSON.stringify(e)}]});if(b[0]&&b[0].dragAll.inputs){b[0].dragAll.inputs=JSON.stringify(b[0].dragAll.inputs);f.dform("load",b[0].dragAll);b[0].dragAll.inputs=JSON.parse(b[0].dragAll.inputs)}}function cloneObj(c){var d,b,a;if(typeof(c)!="object"||c===null){return c}if(c instanceof (Array)){d=[];b=0;a=c.length;for(;b<a;b++){if(typeof(c[b])=="object"&&c[b]!=null){d[b]=arguments.callee(c[b])}else{d[b]=c[b]}}}else{d={};for(b in c){if(typeof(c[b])=="object"&&c[b]!=null){d[b]=arguments.callee(c[b])}else{d[b]=c[b]}}}return d};