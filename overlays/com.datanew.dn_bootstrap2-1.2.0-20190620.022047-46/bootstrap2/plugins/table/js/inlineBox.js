(function(a){var b={cancel:function(c){var d=a(this).data("oldData");a(c).bootstrapTable("load",d);a(c).inlineBox("init")},getNewData:function(){return a(this).data("newData")},submit:function(){},init:function(){var e=a(this).data("bootstrap.table"),d=e.columns,c=e.$el.find("[data-index]"),f=e.data,g=a.extend(true,[],f);a(this).data("oldData",g);a.each(d,function(h,i){if(i.inlineBox){var j=i.field+"";a.each(c,function(l,m){if(a(m).attr("data-index")!=null){l=parseInt(a(m).attr("data-index"));if(a(m).get(0).tagName!=="TR"){return true}var k=f[l][j]==null?"":f[l][j],n=a(m).find("td").eq(h);n.attr({oldValue:k,colNum:h});n.css("background-color",Number(n.parent().attr("data-index"))%2==0?"#95C7E9":"#D3E3EE");n.off("click").on("click",function(s){if(a(s.target).hasClass("form-control")){return}var o=a("<input/>"),q="textBox";if(i.inlineBox&&i.inlineBox.boxType){q=i.inlineBox.boxType}var r=i.inlineBox;if(q==="dateBox"){r=a.extend({},r,{onChange:function(){o.trigger("blur")}})}o.appendTo(a(this).empty())[q](r);var t=o.data(o.siblings(".valueBox").attr("boxtype"));t.setValue(n.attr("oldValue"));t.$textBox.select();t.$textBox.off("blur").on("blur",function(x){t.setValue(t.$textBox.val());if(o[q]("validate")){var w=t.$textBox.val(),y="";f[l][j]=w;if(i.formatter){y=i.formatter.call(this,w)}else{y=w}if(r.onBlur){var v=r.onBlur.call(this,w,f[l]);a.each(v,function(B,D){var E="";var C=d.find(function(F){return F.field==D.column});var A=C.fieldIndex;var z=n.parent().children().get(A);if(d[A].formatter){E=d[A].formatter.call(this,D.value)}else{E=D.value}f[l][D.column]=D.value;a(z).html(E)})}n.attr("oldValue",w);n.css("background-color",Number(n.parent().attr("data-index"))%2==0?"#FCE8CD":"#FFF2E1");n.html(y);if(i.edited){i.edited.call(this,w)}}});t.$textBox.off("keydown").on("keydown",function(w){var v=t.$textBox.parent().parent();if(w.keyCode==13){p(v,-1,"N");this.blur()}else{if(w.keyCode==40){u(v.parent(),v.attr("colnum"),"N")}else{if(w.keyCode==39){p(v,-1,"N")}else{if(w.keyCode==37){p(v,-1,"P")}else{if(w.keyCode==38){u(v.parent(),v.attr("colnum"),"P")}}}}}});function p(x,v,w){if(w=="P"){$nextTd=x.prevAll("[oldvalue]").last()}else{$nextTd=x.nextAll("[oldvalue]").eq(0)}if($nextTd.length==0){u(x.parent(),v,w)}else{$nextTd.click()}}function u(w,v,x){v=Number(v);if(x=="P"){$nextTr=w.prev("tr")}else{$nextTr=w.next("tr")}if($nextTr.length==0){return}if(x=="P"){if(v==-1){$nextLineTd=$nextTr.find("[oldvalue] :last")}else{$nextLineTd=$nextTr.find("td").eq(v)}}else{if(v==-1){$nextLineTd=$nextTr.find("[oldvalue] :eq(0)")}else{$nextLineTd=$nextTr.find("td").eq(v)}}if($nextLineTd.length==0){u($nextTr,v,x)}else{$nextLineTd.click()}}})}})}})}};a.fn.inlineBox=function(d){var c=Array.prototype.slice.call(arguments,1);c.unshift(this);return b[d].apply(this,c)}})(jQuery);