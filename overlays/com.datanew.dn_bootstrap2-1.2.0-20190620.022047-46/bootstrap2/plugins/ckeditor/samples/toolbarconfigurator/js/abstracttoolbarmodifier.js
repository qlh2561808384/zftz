"function"!=typeof Object.create&&function(){var b=function(){};Object.create=function(a){if(1<arguments.length){throw Error("Second argument not supported")}if(null===a){throw Error("Cannot set a null [[Prototype]]")}if("object"!=typeof a){throw TypeError("Argument must be an object")}b.prototype=a;return new b}}();CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(b){b.addMode("wysiwyg",function(a){var d=CKEDITOR.dom.element.createFromHtml('\x3cdiv class\x3d"cke_wysiwyg_div cke_reset" hidefocus\x3d"true"\x3e\x3c/div\x3e');b.ui.space("contents").append(d);d=b.editable(d);d.detach=CKEDITOR.tools.override(d.detach,function(c){return function(){c.apply(this,arguments);this.remove()}});b.setData(b.getData(1),a);b.fire("contentDom")});b.dataProcessor.toHtml=function(a){return a};b.dataProcessor.toDataFormat=function(a){return a}}});Object.keys||(Object.keys=function(){var f=Object.prototype.hasOwnProperty,d=!{toString:null}.propertyIsEnumerable("toString"),h="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),g=h.length;return function(c){if("object"!==typeof c&&("function"!==typeof c||null===c)){throw new TypeError("Object.keys called on non-object")}var a=[],b;for(b in c){f.call(c,b)&&a.push(b)}if(d){for(b=0;b<g;b++){f.call(c,h[b])&&a.push(h[b])}}return a}}());(function(){function b(a,d){this.cfg=d||{};this.hidden=!1;this.editorId=a;this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor;this.actualConfig=this.originalConfig=this.mainContainer=null;this.isEditableVisible=this.waitForReady=!1;this.toolbarContainer=null;this.toolbarButtons=[]}ToolbarConfigurator.AbstractToolbarModifier=b;b.prototype.setConfig=function(a){this._onInit(void 0,a,!0)};b.prototype.init=function(a){var d=this;this.mainContainer=new CKEDITOR.dom.element("div");if(null!==this.fullToolbarEditor.editorInstance){throw"Only one instance of ToolbarModifier is allowed"}this.editorInstance||this._createEditor(!1);this.editorInstance.once("loaded",function(){d.fullToolbarEditor.init(function(){d._onInit(a);if("function"==typeof d.onRefresh){d.onRefresh()}},d.editorInstance.config)});return this.mainContainer};b.prototype._onInit=function(e,p){this.originalConfig=this.editorInstance.config;this.actualConfig=p?JSON.parse(p):JSON.parse(JSON.stringify(this.originalConfig));if(!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var i=this.actualConfig,o=this.editorInstance.toolbar,m=[],n=o.length,j=0;j<n;j++){var l=o[j];"string"==typeof l?m.push(l):m.push({name:l.name,groups:l.groups?l.groups.slice():[]})}i.toolbarGroups=m}"function"===typeof e&&e(this.mainContainer)};b.prototype._createModifier=function(){this.mainContainer.addClass("unselectable");this.modifyContainer&&this.modifyContainer.remove();this.modifyContainer=new CKEDITOR.dom.element("div");this.modifyContainer.addClass("toolbarModifier");this.mainContainer.append(this.modifyContainer);return this.mainContainer};b.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")};b.prototype._hideEditable=function(){var a=this.getEditableArea();this.isEditableVisible=!1;this.lastEditableAreaHeight=a.getStyle("height");a.setStyle("height","0")};b.prototype._showEditable=function(){this.isEditableVisible=!0;this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")};b.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()};b.prototype._refreshEditor=function(){function d(){f.editorInstance.destroy();f._createEditor(!0,f.getActualConfig());f.waitForReady=!1}var f=this,e=this.editorInstance.status;this.waitForReady||("unloaded"==e||"loaded"==e?(this.waitForReady=!0,this.editorInstance.once("instanceReady",function(){d()},this)):d())};b.prototype._createEditor=function(a,h){function f(){}var g=this;this.editorInstance=CKEDITOR.replace(this.editorId);this.editorInstance.on("configLoaded",function(){var c=g.editorInstance.config;h&&CKEDITOR.tools.extend(c,h,!0);b.extendPluginsConfig(c)});this.editorInstance.on("uiSpace",function(c){"top"!=c.data.space&&c.stop()},null,null,-999);this.editorInstance.once("loaded",function(){var e=g.editorInstance.ui.instances,d;for(d in e){e[d]&&(e[d].click=f,e[d].onClick=f)}g.isEditableVisible||g._hideEditable();g.currentActive&&g.currentActive.name&&g._highlightGroup(g.currentActive.name);g.hidden?g.hideUI():g.showUI();if(a&&"function"===typeof g.onRefresh){g.onRefresh()}})};b.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))};b.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div");this.toolbarContainer.addClass("toolbar");for(var a=this.toolbarButtons.length,d=0;d<a;d+=1){this._createToolbarBtn(this.toolbarButtons[d])}}};b.prototype._createToolbarBtn=function(a){var d=ToolbarConfigurator.FullToolbarEditor.createButton("string"===typeof a.text?a.text:a.text.inactive,a.cssClass);this.toolbarContainer.append(d);d.data("group",a.group);d.addClass(a.position);d.on("click",function(){a.clickCallback.call(this,d,a)},this);return d};b.prototype._fixGroups=function(e){e=e.toolbarGroups||[];for(var h=e.length,f=0;f<h;f+=1){var g=e[f];"/"==g?(g=e[f]={},g.type="separator",g.name="separator"+CKEDITOR.tools.getNextNumber()):(g.groups=g.groups||[],-1==CKEDITOR.tools.indexOf(g.groups,g.name)&&(this.editorInstance.ui.addToolbarGroup(g.name,g.groups[g.groups.length-1],g.name),g.groups.push(g.name)),this._fixSubgroups(g))}};b.prototype._fixSubgroups=function(e){e=e.groups;for(var h=e.length,f=0;f<h;f+=1){var g=e[f];e[f]={name:g,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(g,this.fullToolbarEditor)}}};b.stringifyJSONintoOneLine=function(c,d){d=d||{};var f=JSON.stringify(c,null,""),f=f.replace(/\n/g,"");d.addSpaces&&(f=f.replace(/(\{|:|,|\[|\])/g,function(e){return e+" "}),f=f.replace(/(\])/g,function(e){return" "+e}));d.noQuotesOnKey&&(f=f.replace(/"(\w*)":/g,function(g,e){return e+":"}));d.singleQuotes&&(f=f.replace(/\"/g,"'"));return f};b.prototype.hideUI=function(){this.hidden=!0;this.mainContainer.hide();this.editorInstance.container&&this.editorInstance.container.hide()};b.prototype.showUI=function(){this.hidden=!1;this.mainContainer.show();this.editorInstance.container&&this.editorInstance.container.show()};b.extendPluginsConfig=function(d){var e=d.extraPlugins;d.extraPlugins=(e?e+",":"")+"toolbarconfiguratorarea"}})();